<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <!-- PWA应用名称 -->
    <meta name="apple-mobile-web-app-title" content="PWA应用名称" />
    <!-- 是否隐藏地址栏 -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <!-- 修改状态栏颜色 -->
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <link rel="manifest" href="./manifest.json" />
  </head>
  <body>
    11111

    <script>
      function initPWA() {
        document.body.innerHTML += `
  <div  id="bb" style="position: fixed;z-index:999;bottom: 40px;left: 20px;width: calc(100% - 40px);padding: 10px 0 10px 20px;background-color: #1E2730;">
  <div style="display: flex;align-items: flex-start;">
      <img style="height:60px" src="./static/1703135556481-Crazy_777_Slots.png" alt="logo">
      <div style="color: #fff;padding-left: 12px;line-height: 20px;">We would like to add it to your home
          screen for the latest free bets and bonus
          updates.</div>
  </div>
  <div style="display: flex;align-items: center;justify-content: flex-end;margin-top: 12px;">
      <div onclick="uninstall()" style="color: #fff;">Cancel</div>
      <div onclick="install()" style="margin: 0 20px;padding: 8px 30px;background-color: #A259FF;border-radius: 2px;color: #fff;">Agree</div>
  </div>
</div>
  `;
      }
      // if (navigator.serviceWorker != null) {
      //   navigator.serviceWorker
      //     .register("./sw.js")
      //     .then(function (registration) {
      //       console.log("Registered events at scope: ", registration.scope);
      //     });
      // }
      var deferredPrompt;
      console.error(111222);
      window.addEventListener("beforeinstallprompt", function (e) {
        console.error(">???");
        initPWA();
        deferredPrompt = e;
        e.preventDefault();
        return false;
      });
      function uninstall() {
        const bb = document.querySelector("#bb");
        bb.style.display = "none";
      }
      function install() {
        uninstall();
        // 弹出安装提示
        if (deferredPrompt) {
          deferredPrompt.prompt();
          deferredPrompt.userChoice.then((choiceResult) => {
            if (choiceResult.outcome === "accepted") {
              //   console.log("用户安装了应用");
              document.body.innerHTML += `
              <div
    id="msg"
      style="
        z-index: 1000;
        text-align: center;
        padding: 10px;
        border-radius: 2px;
        background-color: rgba(0, 0, 0, 0.7);
        color: #fff;
        text-align: center;
        position: fixed;
        max-width: 80vw;
        top: 50%;
        left: 50%;
        transform: translateX(-50%) translateY(-50%);
      "
    >
      ${tip1}
    </div>
              `;
              setTimeout(() => {
                document.querySelector("#msg").style.display = "none";
              }, 5000);
            } else {
              //   console.log("用户拒绝安装应用");
            }
            // 清除提示
            deferredPrompt = null;
          });
        } else {
          alert("请手动添加网页到屏幕");
        }
      }
    </script>
  </body>
</html>
